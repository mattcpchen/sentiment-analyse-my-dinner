<!DOCTYPE html>
<!-- saved from url=(0132)https://mdobson.static.observableusercontent.com/worker/worker.dd9535076d0183e806262f9c55604314f48d59871fcccb87a6d3c46406d7165d.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--<base target="_top" href="https://observablehq.com/@mdobson/sentiment-analysis-with-tensorflow-js">--><base href="." target="_top">
<style>/*Copyright 2019 Observable, Inc.*/:root{--syntax_normal:#1b1e23;--syntax_comment:#828282;--syntax_diff:#24292e;--syntax_diff_bg:#fbfbfb;--syntax_number:#20a5ba;--syntax_keyword:#c30771;--syntax_atom:#10a778;--syntax_string:#008ec4;--syntax_error:#ffbedc;--syntax_unknown_variable:#838383;--syntax_known_variable:#005f87;--syntax_matchbracket:#20bbfc;--syntax_key:#6636b4;--selection:#d7d4f0;--hr:rgba(0,0,0,0.05);--mono_fonts:14px/1.5 Menlo,Consolas,monospace;--serif:"Iowan Old Style","Apple Garamond",Baskerville,"Palatino Linotype","Times New Roman","Droid Serif",Times,"Source Serif Pro",serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--sans-serif:-apple-system,BlinkMacSystemFont,"avenir next",avenir,helvetica,"helvetica neue",ubuntu,roboto,noto,"segoe ui",arial,sans-serif}body{margin:0 14px;font-family:var(--serif);font-size:17px;line-height:1.5;-webkit-text-size-adjust:100%;-webkit-font-smoothing:antialiased;color:#1b1e23}body.fullscreen{margin:0}h1,h2,h3,h4,h5,h6{color:#333;font-family:var(--sans-serif);font-weight:600;line-height:1.15;margin-top:0;margin-bottom:.25em}h2~p,h3~p,h4~p{margin-top:0}a[href]{text-decoration:none}a[href]:hover{text-decoration:underline}h1 code,h2 code,h3 code,h4 code,h5 code,h6 code{font-size:90%}code,pre,tt{font:var(--mono_fonts)}img{max-width:calc(100vw - 28px)}.katex-display,figure,h1,h2,h3,h4,h5,h6,p,table{max-width:640px}blockquote,ol,ul{max-width:600px}blockquote{margin:1em 1.5em}ol,ul{padding-left:28px}ul{list-style:none}ul li:before{content:"\2022";position:absolute;margin-left:-17px}hr{height:1px;margin:1em 0;padding:1em 0;border:none;background:no-repeat 50%/100% 1px linear-gradient(90deg,var(--hr),var(--hr))}pre{padding:2px 0}.observablehq--md-pre{overflow-x:auto}.observablehq>link:only-child,.observablehq>style:only-child{display:block;visibility:hidden;padding:6px 0;white-space:nowrap;font:var(--mono_fonts);color:var(--syntax_keyword)}.observablehq>link:only-child:before{content:"<link>";visibility:visible}.observablehq>style:only-child:before{content:"<style>";visibility:visible}input:not([type]),input[type=email],input[type=number],input[type=password],input[type=range],input[type=search],input[type=tel],input[type=text],input[type=url]{width:240px}canvas,input{vertical-align:middle}table{width:100%;border-collapse:collapse;font-family:var(--sans-serif);font-size:14px}th{text-align:left}tr:not(:last-child){border-bottom:1px solid #eee}thead tr{border-bottom:1px solid #ccc}figure{margin:1em 0}figure img{max-width:100%}figcaption{font:small var(--sans-serif);color:var(--syntax_unknown_variable)}.observablehq--collapsed,.observablehq--expanded,.observablehq--function,.observablehq--gray,.observablehq--import,.observablehq--string:after,.observablehq--string:before{color:var(--syntax_normal)}.observablehq--collapsed,.observablehq--inspect a{cursor:pointer}.observablehq--caret{margin-right:4px;vertical-align:baseline}.observablehq--field{text-indent:-1em;margin-left:1em}.hljs-comment,.observablehq--empty{color:var(--syntax_comment)}.hljs-built_in{color:var(--syntax_known_variable)}.observablehq--unknown{color:var(--syntax_unknown_variable)}.hljs-doctag,.hljs-keyword,.hljs-name,.hljs-section,.hljs-selector-class,.hljs-selector-id,.hljs-selector-tag,.hljs-strong,.hljs-tag,.hljs-type{color:var(--syntax_keyword)}.observablehq--blue,.observablehq--keyword,a[href]{color:#3182bd}.hljs-deletion,.hljs-variable,.observablehq--forbidden,.observablehq--pink{color:#e377c2}.observablehq--orange{color:#e6550d}.hljs-literal,.observablehq--boolean,.observablehq--null,.observablehq--undefined{color:var(--syntax_atom)}.hljs-bullet,.hljs-link,.hljs-number,.hljs-regexp,.observablehq--bigint,.observablehq--date,.observablehq--green,.observablehq--number,.observablehq--regexp,.observablehq--symbol{color:var(--syntax_number)}.observablehq--index,.observablehq--key{color:var(--syntax_key)}.observablehq--empty{font-style:oblique}.hljs-addition,.hljs-meta,.hljs-string,.hljs-symbol,.hljs-template-tag,.hljs-template-variable,.observablehq--purple,.observablehq--string{color:var(--syntax_string)}.observablehq--error,.observablehq--red{color:#e7040f}.observablehq{position:relative;margin:17px 0;min-height:33px}.observablehq:before{content:"";position:absolute;left:-14px;height:100%;width:4px;background-color:none;transition:background-color .25s linear}.observablehq--changed:before,.observablehq--running:before{background-color:#a9b0bc;transition:none}.observablehq--error:before{background-color:#e7040f}.observablehq--inspect{font:var(--mono_fonts);overflow-x:auto;display:block;padding:6px 0;white-space:pre}.observablehq--inspect.observablehq--import{white-space:normal}.observablehq--inspect::-webkit-scrollbar{display:none}.observablehq--error .observablehq--inspect{word-break:break-all;white-space:pre-wrap}.observablehq--string-expand{margin-left:6px;padding:2px 6px;border-radius:2px;font-size:80%;background:#eee;color:var(--syntax_normal);cursor:pointer;vertical-align:middle;position:sticky;right:0}.observablehq--string-expand:active,.observablehq--string-expand:hover{background:#ddd}</style>
</head><body>
<script src="./worker.731df38bc78c5200f5b38b6c25e9bb975fbf691e179c435ed1a2da8a5a9f7430.js"></script><div id="r0" dir="auto" class="observablehq" style="margin-bottom: 17px;"><div><h1 id="sentiment-analysis-with-tensorflow-js">Sentiment Analysis with Tensorflow.js</h1>
<p>A quick port of the <a href="https://github.com/tensorflow/tfjs-examples/tree/master/sentiment">official example</a> to Observable, using Google‚Äôs pre-trained example model. The model was trained against 25,000 film reviews from IMDB, labeled either positive (1), or negative (0).</p></div></div><div id="r24" dir="auto" class="observablehq" style="margin-bottom: 17px;"><span class="observablehq--inspect"><span class="observablehq--cellname">positivity = </span><span class="observablehq--number">0.5</span></span></div><div id="r65" dir="auto" class="observablehq" style="margin-bottom: 17px;"><span style="font-size: 50px;">üòê</span></div><div id="r16" dir="auto" class="observablehq" style="margin-bottom: 17px;"><form><div><textarea style="display: block; font-size: 0.8em;" name="input" cols="80" rows="10" placeholder="Type a positive or negative comment. Longer ‚Äúreviews‚Äù seem to work better than short ones..."></textarea></div></form></div><div id="r180" dir="auto" class="observablehq" style="margin-bottom: 17px;"><p>Or, try a random Metacritic review of a recent, controversial film:</p></div><div id="r182" dir="auto" class="observablehq" style="margin-bottom: 17px;"><form><div>
	<input name="input" type="button" value="Random review of ‚ÄúThe Last Jedi‚Äù">
  </div></form></div><div id="r82" dir="auto" class="observablehq" style="margin-bottom: 17px;"><h3 id="tensorflow-js-bits">Tensorflow.js bits</h3></div><div id="r31" dir="auto" class="observablehq observablehq--error" style="margin-bottom: 239px;"><div class="observablehq--inspect"><span class="observablehq--cellname">predict = </span>RuntimeError: model could not be resolved</div></div><div id="r42" dir="auto" class="observablehq observablehq--error" style="margin-bottom: 92px;"><div class="observablehq--inspect"><span class="observablehq--cellname">model = </span>TypeError: tf.loadModel is not a function</div></div><div id="r9" dir="auto" class="observablehq" style="margin-bottom: 50px;"><span class="observablehq--collapsed observablehq--inspect"><span class="observablehq--cellname">metadata = </span><a><svg width="8" height="8" class="observablehq--caret">
    <path d="M7 4L1 8V0z" fill="currentColor"></path>
  </svg>Object {</a><span class="observablehq--key">epochs</span>: <span><span class="observablehq--number">5</span></span>, <span class="observablehq--key">index_from</span>: <span><span class="observablehq--number">3</span></span>, <span class="observablehq--key">embedding_size</span>: <span><span class="observablehq--number">128</span></span>, <span class="observablehq--key">max_len</span>: <span><span class="observablehq--number">100</span></span>, <span class="observablehq--key">model_type</span>: <span><span class="observablehq--string">"cnn"</span></span>, <span class="observablehq--key">word_index</span>: <span class="observablehq--shallow">Object</span>, <span class="observablehq--key">batch_size</span>: <span><span class="observablehq--number">32</span></span>, <span class="observablehq--key">vocabulary_size</span>: <span><span class="observablehq--number">20000</span></span>}</span></div><div id="r5" dir="auto" class="observablehq" style="margin-bottom: 50px;"><span class="observablehq--collapsed observablehq--inspect"><span class="observablehq--cellname">tf = </span><a><svg width="8" height="8" class="observablehq--caret">
    <path d="M7 4L1 8V0z" fill="currentColor"></path>
  </svg>Object {</a><span class="observablehq--key">ENV</span>: <span class="observablehq--shallow">t</span>, <span class="observablehq--key">Rank</span>: <span class="observablehq--shallow">Object</span>, <span class="observablehq--key">Reduction</span>: <span class="observablehq--shallow">Object</span>, <span class="observablehq--key">data</span>: <span class="observablehq--shallow">Object</span>, <span class="observablehq--key">version</span>: <span class="observablehq--shallow">Object</span>, <span class="observablehq--key">AdadeltaOptimizer</span>: <span class="observablehq--function"><span class="observablehq--keyword">∆í</span>(e, n, r)</span>, <span class="observablehq--key">AdagradOptimizer</span>: <span class="observablehq--function"><span class="observablehq--keyword">∆í</span>(e, n)</span>, <span class="observablehq--key">AdamOptimizer</span>: <span class="observablehq--function"><span class="observablehq--keyword">∆í</span>(e, n, r, i)</span>, <span class="observablehq--key">AdamaxOptimizer</span>: <span class="observablehq--function"><span class="observablehq--keyword">∆í</span>(e, n, r, i, a)</span>, <span class="observablehq--key">DataStorage</span>: <span class="observablehq--function"><span class="observablehq--keyword">∆í</span>(t, e)</span>, <span class="observablehq--key">Environment</span>: <span class="observablehq--function"><span class="observablehq--keyword">∆í</span>(t)</span>, <span class="observablehq--key">KernelBackend</span>: <span class="observablehq--function"><span class="observablehq--keyword">∆í</span>()</span>, <span class="observablehq--key">MomentumOptimizer</span>: <span class="observablehq--function"><span class="observablehq--keyword">∆í</span>(e, n, r)</span>, <span class="observablehq--key">Optimizer</span>: <span class="observablehq--function"><span class="observablehq--keyword">∆í</span>()</span>, <span class="observablehq--key">RMSPropOptimizer</span>: <span class="observablehq--function"><span class="observablehq--keyword">∆í</span>(e, n, r, i, a)</span>, <span class="observablehq--key">SGDOptimizer</span>: <span class="observablehq--function"><span class="observablehq--keyword">∆í</span>(e)</span>, <span class="observablehq--key">Tensor</span>: <span class="observablehq--function"><span class="observablehq--keyword">∆í</span>(t, e, n, r, i)</span>, <span class="observablehq--key">TensorBuffer</span>: <span class="observablehq--function"><span class="observablehq--keyword">∆í</span>(t, e, n)</span>, <span class="observablehq--key">Variable</span>: <span class="observablehq--function"><span class="observablehq--keyword">∆í</span>(e, n, r)</span>, <span class="observablehq--key">abs</span>: <span class="observablehq--function"><span class="observablehq--keyword">∆í</span>()</span>, ‚Ä¶}</span></div><div id="r17" dir="auto" class="observablehq" style="margin-bottom: 17px;"><span class="observablehq--inspect observablehq--import">import {<a href="https://observablehq.com/@jashkenas/inputs#button">button</a>, <a href="https://observablehq.com/@jashkenas/inputs#textarea">textarea</a>} from <a href="https://observablehq.com/@jashkenas/inputs">@jashkenas/inputs</a></span></div><div id="r87" dir="auto" class="observablehq" style="margin-bottom: 17px;"><h3 id="metacritic-reviews-bits">Metacritic reviews bits</h3></div><div id="r187" dir="auto" class="observablehq" style="margin-bottom: 134px;"><span class="observablehq--inspect"><span class="observablehq--cellname">review = </span><span class="observablehq--boolean">true</span></span></div><div id="r89" dir="auto" class="observablehq" style="margin-bottom: 92px;"><span class="observablehq--collapsed observablehq--inspect"><span class="observablehq--cellname">tljReviews = </span><a><svg width="8" height="8" class="observablehq--caret">
    <path d="M7 4L1 8V0z" fill="currentColor"></path>
  </svg>Object {</a><span class="observablehq--key">text</span>: <span><span class="observablehq--string">"\n                                &lt;div class=\"revie‚Ä¶        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/footer&gt;\n\n\n    &lt;/div&gt;\n"</span></span>}</span></div><div id="r97" dir="auto" class="observablehq" style="margin-bottom: 176px;"><span class="observablehq--collapsed observablehq--inspect"><span class="observablehq--cellname">tljHTML = </span><a><svg width="8" height="8" class="observablehq--caret">
    <path d="M7 4L1 8V0z" fill="currentColor"></path>
  </svg>HTMLDocument {</a><span class="observablehq--key">location</span>: <span><span class="observablehq--null">null</span></span>}</span></div><div id="r106" dir="auto" class="observablehq" style="margin-bottom: 218px;"><span class="observablehq--collapsed observablehq--inspect"><span class="observablehq--cellname">reviews = </span><a><svg width="8" height="8" class="observablehq--caret">
    <path d="M7 4L1 8V0z" fill="currentColor"></path>
  </svg>Array(100) [</a><span class="observablehq--shallow">Object</span>, <span class="observablehq--shallow">Object</span>, <span class="observablehq--shallow">Object</span>, <span class="observablehq--shallow">Object</span>, <span class="observablehq--shallow">Object</span>, <span class="observablehq--shallow">Object</span>, <span class="observablehq--shallow">Object</span>, <span class="observablehq--shallow">Object</span>, <span class="observablehq--shallow">Object</span>, <span class="observablehq--shallow">Object</span>, <span class="observablehq--shallow">Object</span>, <span class="observablehq--shallow">Object</span>, <span class="observablehq--shallow">Object</span>, <span class="observablehq--shallow">Object</span>, <span class="observablehq--shallow">Object</span>, <span class="observablehq--shallow">Object</span>, <span class="observablehq--shallow">Object</span>, <span class="observablehq--shallow">Object</span>, <span class="observablehq--shallow">Object</span>, <span class="observablehq--shallow">Object</span>, ‚Ä¶]</span></div></body></html>